<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <title>title</title>
    <link rel="stylesheet" type="text/css" href="../css/aui.css" />
    <style>
        html,
        body {
            height: 100%;
            min-height: 100%;
        }

        section {
            height: 100%;
        }

        .info-name {
            box-sizing: border-box;
            width: 100%;
            height: 61px;
            padding-top: 8px;
            padding-left: 8px;
            border-bottom: 1px solid #ddd;
        }

        .info-name .name {
            width: 100%;
            height: 24px;
            line-height: 24px;
            color: #444;
            font-size: 18px;
        }

        .info-name .description {
            width: 100% height: 20px;
            line-height: 20px;
            color: #888;
            font-size: 14px;
        }

        .info-price {
            box-sizing: border-box;
            width: 100%;
            height: 61px;
            padding-top: 8px;
            padding-left: 8px;
            border-bottom: 1px solid #ddd;
        }

        .info-price .price {
            width: 100%;
            height: 24px;
            line-height: 24px;
            color: #e3007f;
            font-size: 24px;
            font-weight: bolder;
        }

        .info-price .other {
            display: -webkit-box;
            display: -webkit-flex;
            display: flex;
            -webkit-box-orient: horizontal;
            -webkit-flex-flow: row;
            flex-flow: row;
            width: 100%;
            height: 20px;
        }

        .info-price .other div {
            width: 100%;
            height: 20px;
            -webkit-box-flex: 1;
            -webkit-flex: 1;
            flex: 1;
            line-height: 20px;
            font-size: 14px;
            color: #888;
        }

        .info-price .other .origin-price {
            box-sizing: border-box;
            padding-left: 8px;
            text-align: left;
        }

        .info-price .other .unit {
            box-sizing: border-box;
            text-align: center;
        }

        .info-price .other .place {
            box-sizing: border-box;
            padding-right: 16px;
            text-align: right;
        }

        .info-discount {
            box-sizing: border-box;
            width: 100%;
            height: 40px;
            border-bottom: 1px solid #ddd;
        }

        .info-discount .name {
            display: inline-block;
            width: auto;
            height: 15px;
            margin-top: 8px;
            margin-left: 8px;
            color: #444;
        }

        .info-discount .value {
            display: inline-block;
            width: auto;
            height: 24px;
            line-height: 15px;
            margin-top: 3px;
            padding: 4px;
            border-radius: 15px;
            box-shadow: 0 1px 1px 1px #eee;
            color: #fff;
            background-color: #e3007f;
        }

        .push {
            position: relative;
            box-sizing: border-box;
            padding-top: 8px;
            width: 100%;
            height: 60px;
            text-align: center;
            color: #888;
            font-size: 12px;
        }

        .push .top {
            height: 24px;
            line-height: 24px;
        }

        .push .bottom {
            height: 20px;
            line-height: 20px;
        }
        .picture{
          height: auto;
          width: auto;
        }
        .picture img{
          width: 90%;
          height: auto;
          margin: 0 auto;
        }
    </style>
</head>

<body>
    <section>
        <div id="picture"></div>
        <div class="info-name">
            <div id="wareName" class="name">商品名:</div>
            <div id="description" class="description">商品描述:</div>
        </div>
        <div class="info-price">
            <div id="price" class="price">¥18.9</div>
            <div class="other">
                <div class="origin-price">
                    <del id="originPrice">原价：</del>
                </div>
                <div id="stock" class="place">销量：0件</div>

            </div>
        </div>
        <div class="info-discount">
            <div class="name">优惠活动：</div>
            <div id="discount" class="value">可参与</div>
        </div>

        <div class="picture">
            <img id="pic3" src="" />
        </div>
        <div class="picture">
            <img id="pic4" src="" />
        </div>
        <div class="picture">
            <img id="pic5" src="" />
        </div>

        <!--  <div class="push">
            <div class="top">""</div>
            <div class="bottom">下滑查看商品详情</div>
        </div>-->
    </section>
</body>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript" src="../script/SHA1.js"></script>
<script type="text/javascript" src="../script/remotedb.js"></script>
<script type="text/javascript" src="../script/download.js"></script>
<script type="text/javascript">
    apiready = function() {
        // 初始化轮播图模块
        initUIScrollPicture();
        // 获取商品详情数据
        getWareInfo(api.pageParam.wareId);
    };

    var UIScrollPicture;

    function initUIScrollPicture() {

        // 获取占位的div元素，并设置元素的宽高
        var picture = $api.byId('picture');
        picture.style.width = api.winWidth  + 'px';
        picture.style.height = api.winWidth*0.8  + 'px';

        var rect = $api.offset(picture);

        // 引入UIScrollPicture模块，并指定位置和宽高
        UIScrollPicture = api.require('UIScrollPicture');
        UIScrollPicture.open({
            rect: {
                x: rect.l,
                y: rect.t,
                w: rect.w,
                h: rect.h
            },
            data: {
                paths: [
                    //'widget://image/demo1.png',
                    //'widget://image/demo2.png',

                ]
            },
            styles: {
                caption: {
                    height: 35,
                    color: '#E0FFFF',
                    size: 13,
                    bgColor: '#696969',
                    position: 'bottom'
                },
                indicator: {
                    align: 'center',
                    color: '#FFFFFF',
                    activeColor: '#DA70D6'
                }
            },
            placeholderImg: 'widget://image/default_square.png',
            contentMode: 'scaleAspectFit',
            interval: 5,
            fixedOn: api.frameName,
            auto:true,
            loop: true,
            fixed: false
        }, function(ret, err) {
            if (ret) {
                //alert(JSON.stringify(ret));
            } else {
                //alert(JSON.stringify(err));
            }
        });
    }


    function getWareInfo(wareId_) {
        api.showProgress({
            style: 'default',
            animationType: 'fade',
            title: '努力加载中...',
            text: '请稍候...',
            modal: false
        });
        var filter = {
            where: {
                'Id': wareId_
            },
            skip: 0,
            limit: 1
        }
        fnGet('Spl_Ware/GetByID', filter, function(ret, err) {
          console.log(JSON.stringify(ret));
            api.hideProgress();
            // 更新商品详情展示
            fnUpdateWareInfo(ret);

            //console.log(JSON.stringify(ret));
        });
    }

    // 更新商品详情展示
    function fnUpdateWareInfo(ware_) {

        // 商品名称
        var wareName = $api.byId('wareName');
        wareName.innerHTML = ware_.Name;

        // 商品描述
        var description = $api.byId('description');
        description.innerHTML = ware_.Description;

        // 商品价格
        var price = $api.byId('price');
        price.innerHTML = '价格：￥ ' + ware_.Price;
        //商品原价
        var originPrice = $api.byId('originPrice');
        if (ware_.OriginPrice != null) {
            originPrice.innerHTML = '原价：￥ ' + ware_.OriginPrice;
        }

        //销售
        var stock = $api.byId('stock');
        if (ware_.Stock != null) {
            stock.innerHTML = '销量： ' + ware_.Stock;
        }
        //优惠活动
        var discount=$api.byId('discount');
        if (ware_.YTypeName) {
            discount.innerHTML+=ware_.YTypeName;
        }
        else {
            discount.innerHTML='无';
        }

        //图片介绍
        var pic3 = $api.byId('pic3');
        var pic4 = $api.byId('pic4');
        var pic5 = $api.byId('pic5');


        if (ware_.Picture3) {
          fnLoadImage(pic3, ware_.Picture3)
            //pic3.src = ware_.Picture3;
        }else {
          pic3.display='none';
        }
        if (ware_.Picture4) {
            fnLoadImage(pic4, ware_.Picture4)
        }else {
          pic4.display='none';
        }
        if (ware_.Picture5) {
            fnLoadImage(pic5, ware_.Picture5)
        }else {
          pic5.display='none';
        }



        // 更新轮播图中的图片
        var paths = [];
        if (ware_.Picture0) {

            //"widget://"+ware_.Picture0.substring(3)
            //paths.push("widget://" + ware_.Picture0.substring(3));//截取掉“../”
            paths.push(fnLoadImage(ware_.Picture0));
        }
        if (ware_.Picture1) {
            paths.push(fnLoadImage(ware_.Picture1));
        }
        if (ware_.Picture2) {
            paths.push(fnLoadImage(ware_.Picture2));
        }


        UIScrollPicture.reloadData({
            data: {
                paths: paths
            }
        });
    }

</script>

</html>
