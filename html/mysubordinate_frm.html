<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <title>title</title>
    <link rel="stylesheet" type="text/css" href="../css/aui.css" />
    <link rel="stylesheet" type="text/css" href="../css/aui-iconfont.css" />
    <style>
        body {}
    </style>
</head>

<body>
  <div class="aui-content aui-margin-b-15">
      <ul class="aui-list aui-list-in" id="list">



        </ul>
        </div>
    </section>
</body>
<script type="text/template" id="template">
    {{for(var i=0;i
    <it[it.length-1].levelMan;i++){}} <li class="aui-list-header">
            <div class="aui-list-item-title">{{=i+1}}级下属</div>

        </li>

            {{for(var j=0;j
            <it.length;j++){}} {{?it[j].levelMan===i+1}}
             <li class="aui-list-item">
                <div class="aui-list-item-inner">
                    <div class="aui-list-item-title">{{=it[j].trueName}}</div>
                    <div class="aui-list-item-right">{{=it[j].levelName}}</div>
                </div>
                </li>

                {{?}} {{}}} {{}}}
</script>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript" src="../script/aui-collapse.js"></script>
<script type="text/javascript" src="../script/doT.min.js"></script>
<script type="text/javascript" src="../script/SHA1.js"></script>
<script type="text/javascript" src="../script/remotedb.js"></script>
<script type="text/javascript">
    apiready = function() {
      api.parseTapmode();
      list = $api.byId('list');
        fnGetChildren($api.getStorage('userInfo').Id);  
};
    function fnGetChildren(uid_) {
        var params = {
            where: {
                'uid': uid_
            },
            skip: 0,
            limit: 200
        }
        fnGet('SysUser/GetAllChildren', params, function(ret, err) {
            if (ret) {
                fnUpdateList(ret);
            } else {
                api.toast({
                    msg: '加载数据失败',
                    duration: 2000,
                    location: 'bottom'
                });
            }
            // 隐藏加载状态对话框
            api.hideProgress();
        });
    }
    var list;
    function fnUpdateList(data_) {
        var tempFn = doT.template($api.byId('template').innerHTML);
        list.innerHTML=tempFn(data_);
        api.parseTapmode();
    }
</script>

</html>
